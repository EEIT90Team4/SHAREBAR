<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
html, body {
	height: 100%;
	margin: 0;
	padding: 0;
}

#map {
	height: 100%;
	width: 50%;
	position: absolute;
	right: 0px;
}
</style>
</head>
<body>
	<div id="map"></div>
	<div>
		<span>Address: </span>
		<input type="text" id="address" style="width:400px">
	</div>
	<div>
		<span>Lat: </span>
		<input type="text" id="lat">
		<span>Lng: </span>
		<input type="text" id="lon">
	</div>

	<script>
		var map;
		var marker;
		var markerArray = [];

		function initMap() {
			map = new google.maps.Map(document.getElementById("map"), {
				center : {
					lat : 25.0329636,
					lng : 121.56542680000007
				},
				zoom : 12
			});

			google.maps.event.addListener(map, "click", function(event) {
				deleteMarkers();

				var clickLat = event.latLng.lat();
				var clickLon = event.latLng.lng();

				document.getElementById("lat").value = clickLat.toFixed(6);
				document.getElementById("lon").value = clickLon.toFixed(6);

				marker = new google.maps.Marker({
					position : new google.maps.LatLng(clickLat, clickLon),
					map : map
				});
				markerArray.push(marker);
				
				var LatLng = { lat: clickLat, lng: clickLon };
				
				var geocoder = new google.maps.Geocoder();
				geocoder.geocode({ 'location': LatLng }, function(results, status) {
					if (status === google.maps.GeocoderStatus.OK) {
						if (results[0]) {
							document.getElementById("address").value = results[0].formatted_address;
						} 
					}
				});
			});
		}

		function deleteMarkers() {
			clearMarkers();
			markerArray = [];
		}

		function clearMarkers() {
			setMapOnAll(null);
		}

		function setMapOnAll(map) {
			for (var i = 0; i < markerArray.length; i++) {
				markerArray[i].setMap(map);
			}
		}
	</script>
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAJznZ1ht-uJFa-tBJBpYYtzQ2609ba2Eg&libraries=places&callback=initMap&language=zh-TW"></script>
</body>
</html>